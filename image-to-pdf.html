<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Image → PDF — Free Image Resizer</title>

  <link rel="icon" type="image/png" href="assets/favicon.png" />
  <meta property="og:image" content="assets/logo.png" />
  <meta name="description" content="Convert one or many images to a single PDF (original quality)." />

  <!-- Global CSS -->
  <link rel="stylesheet" href="style.css" />

  <!-- jsPDF WITHOUT INTEGRITY (works correctly) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    /* ---------- PAGE-SPECIFIC TWEAKS ---------- */
    .pdf-container {
      max-width: 1200px;
      margin: 30px auto;
      display: grid;
      grid-template-columns: 1fr 1fr 280px;
      gap: 20px;
      padding: 10px;
    }

    @media(max-width: 900px) {
      .pdf-container {
        grid-template-columns: 1fr;
      }
    }

    /* Upload area */
    .drop-area.small {
      min-height: 200px;
      display:flex;
      align-items:center;
      justify-content:center;
      flex-direction:column;
    }

    /* Thumbnails panel */
    .thumb-box {
      background:#111a2e;
      border:1px solid #1d2944;
      border-radius:10px;
      padding:14px;
    }
    .thumb-header {
      display:flex;
      justify-content:space-between;
      margin-bottom:10px;
    }
    .thumb-list {
      display:flex;
      flex-wrap:wrap;
      gap:10px;
    }
    .thumb {
      width:110px;
      padding:8px;
      background:#0f1829;
      border-radius:8px;
      border:1px solid #2b3b5a;
      text-align:center;
      cursor:grab;
    }
    .thumb img {
      width:100%;
      height:70px;
      object-fit:cover;
      border-radius:6px;
      margin-bottom:6px;
    }
    .thumb button {
      padding:5px 8px;
      font-size:12px;
      background:#273556;
      color:#dbefff;
      border:none;
      border-radius:6px;
      cursor:pointer;
    }
    .thumb.dragging { opacity:0.5; }

    /* Settings Panel */
    .settings-panel {
      background:#131d32;
      border:1px solid #1d2944;
      padding:20px;
      border-radius:10px;
      height:fit-content;
    }
    .settings-panel h3 {
      color:#7fc6ff;
      margin-bottom:10px;
    }
    .small-input {
      width:100%;
      padding:10px;
      border-radius:8px;
      background:#0f1829;
      color:#e8ecf4;
      border:1px solid #2b3b5a;
      font-size:14px;
      margin-bottom:10px;
    }
    .generate-btn {
      width:100%;
      padding:12px;
      background:#1f9bff;
      color:white;
      border:none;
      border-radius:8px;
      cursor:pointer;
      margin-top:10px;
      font-size:16px;
    }
  </style>
</head>

<body>

<!-- NAVBAR -->
<nav class="top-nav">
  <div class="nav-left">
    <img src="assets/logo.png" class="nav-logo" alt="logo">
    <span class="nav-title">Free Image Resizer</span>
  </div>

  <div class="hamburger" id="hamburger">☰</div>

  <div class="nav-links" id="mobileMenu">

    <!-- Tools Menu -->
    <div class="dropdown">
      <button class="dropbtn">Tools ▼</button>
      <div class="dropdown-content">
        <a href="index.html">Image Resizer</a>
        <a href="compress.html">Image Compressor</a>
        <a href="image-to-pdf.html">Image → PDF</a>
      </div>
    </div>

    <a href="about.html">About Us</a>
    <a href="faq.html">FAQ</a>
    <a href="privacy.html">Privacy Policy</a>
    <a href="terms.html">Terms of Service</a>
    <a href="contact.html">Contact</a>
  </div>
</nav>

<header class="head">
  <img src="assets/logo.png" class="logo" alt="logo">
  <h1>Image → PDF Converter</h1>
  <p class="tagline">Convert multiple images into a single high-quality PDF.</p>
</header>


<!-- MAIN 3-COLUMN LAYOUT -->
<div class="pdf-container">

  <!-- LEFT: UPLOADER -->
  <div id="drop-area" class="drop-area small">
    <h3>Drop images</h3>
    <p class="muted">or click to upload</p>
    <input id="fileInput" type="file" multiple accept="image/*" hidden />
  </div>

  <!-- MIDDLE: THUMBNAILS -->
  <div class="thumb-box">
    <div class="thumb-header">
      <strong>Images</strong>
      <span class="muted" id="count">0 files</span>
    </div>
    <div id="thumbList" class="thumb-list"></div>
  </div>

  <!-- RIGHT: SETTINGS PANEL -->
  <div class="settings-panel">
    <h3>PDF Settings</h3>

    <label class="muted">Page Size</label>
    <select id="pageSize" class="small-input">
      <option value="original">Original (no loss)</option>
      <option value="a4">A4</option>
      <option value="letter">Letter</option>
      <option value="legal">Legal</option>
      <option value="custom">Custom</option>
    </select>

    <div id="customSizeRow" style="display:none;">
      <input id="customWidth" class="small-input" type="number" placeholder="Width" />
      <input id="customHeight" class="small-input" type="number" placeholder="Height" />
      <select id="customUnit" class="small-input">
        <option value="mm">mm</option>
        <option value="cm">cm</option>
        <option value="px">px</option>
      </select>
    </div>

    <label class="muted">Orientation</label>
    <select id="orientation" class="small-input">
      <option value="portrait">Portrait</option>
      <option value="landscape">Landscape</option>
    </select>

    <button id="generateBtn" class="generate-btn">Generate PDF</button>
  </div>

</div>


<footer>
  <p>© <span id="year"></span> Free Image Resizer — All rights reserved</p>
</footer>


<!-- =========================== -->
<!--        MAIN SCRIPT          -->
<!-- =========================== -->
<script>
const { jsPDF } = window.jspdf;

const fileInput = document.getElementById("fileInput");
const dropArea = document.getElementById("drop-area");
const thumbList = document.getElementById("thumbList");
const countEl = document.getElementById("count");

let files = [];  // { file, url, id, img }

/* ---------------- UPDATE COUNT ---------------- */
function updateCount() {
  countEl.textContent = files.length + " file" + (files.length === 1 ? "" : "s");
}

/* ---------------- RENDER THUMBNAILS ---------------- */
function renderThumbs() {
  thumbList.innerHTML = "";

  files.forEach(item => {
    const div = document.createElement("div");
    div.className = "thumb";
    div.draggable = true;
    div.dataset.id = item.id;

    div.innerHTML = `
      <img src="${item.url}">
      <div style="font-size:12px">${item.file.name}</div>
      <button>Remove</button>
    `;

    /* Remove button */
    div.querySelector("button").onclick = () => {
      files = files.filter(f => f.id !== item.id);
      renderThumbs();
    };

    /* Drag start */
    div.addEventListener("dragstart", e => {
      e.dataTransfer.setData("id", item.id);
      div.classList.add("dragging");
    });

    /* Drag end */
    div.addEventListener("dragend", () => {
      div.classList.remove("dragging");
    });

    /* Drag over (drop reorder) */
    div.addEventListener("dragover", e => {
      e.preventDefault();
      const draggingId = e.dataTransfer.getData("id");
      const overId = div.dataset.id;

      if (draggingId === overId) return;

      const fromIndex = files.findIndex(x => x.id === draggingId);
      const toIndex = files.findIndex(x => x.id === overId);

      const moved = files.splice(fromIndex, 1)[0];
      files.splice(toIndex, 0, moved);

      renderThumbs();
    });

    thumbList.appendChild(div);
  });

  updateCount();
}

/* ---------------- HANDLE FILES ---------------- */
function handleSelectedFiles(list) {
  [...list].forEach(file => {
    if (!file.type.startsWith("image/")) return;

    const id = Math.random().toString(36).slice(2, 9);
    const url = URL.createObjectURL(file);

    const img = new Image();
    img.src = url;

    files.push({ file, url, id, img });
  });

  renderThumbs();
}

/* Upload listeners */
dropArea.onclick = () => fileInput.click();
fileInput.onchange = () => {
  handleSelectedFiles(fileInput.files);
  fileInput.value = "";
};
dropArea.ondragover = e => e.preventDefault();
dropArea.ondrop = e => {
  e.preventDefault();
  handleSelectedFiles(e.dataTransfer.files);
};

/* ---------------- CUSTOM SIZE UI ---------------- */
document.getElementById("pageSize").addEventListener("change", () => {
  const show = document.getElementById("pageSize").value === "custom";
  document.getElementById("customSizeRow").style.display = show ? "block" : "none";
});

/* ---------------- PDF GENERATION (CROP FIX APPLIED) ---------------- */
document.getElementById("generateBtn").onclick = async () => {
  if (!files.length) return alert("Add at least one image first.");

  const pageSize = document.getElementById("pageSize").value;
  const orientation = document.getElementById("orientation").value;

  let pdf;

  for (let i = 0; i < files.length; i++) {
    const item = files[i];
    const img = item.img;

    await imgDecode(img);

    let pageW, pageH;

    if (pageSize === "original") {
      pageW = img.naturalWidth;
      pageH = img.naturalHeight;
    } else {
      ({ pageW, pageH } = getStandardPageSize(pageSize, orientation));
    }

    /* First page */
    if (i === 0) {
      pdf = new jsPDF({
        unit: "px",
        format: [pageW, pageH],
        orientation: orientation,
        compress: false
      });
    } else {
      pdf.addPage([pageW, pageH], orientation);
    }

    /* AUTO-FIT to avoid cropping */
    const ratio = Math.min(pageW / img.naturalWidth, pageH / img.naturalHeight, 1);
    const drawW = img.naturalWidth * ratio;
    const drawH = img.naturalHeight * ratio;

    const x = (pageW - drawW) / 2;
    const y = (pageH - drawH) / 2;

    pdf.addImage(img, "JPEG", x, y, drawW, drawH);
  }

  pdf.save("images.pdf");
};

/* Helper: accurate image load */
function imgDecode(img) {
  return new Promise(res => {
    if (img.complete) return res();
    img.onload = () => res();
  });
}

/* Standard page sizes in px (converted from mm @ 96 DPI) */
function getStandardPageSize(type, orientation) {
  const DPI = 96;
  const mmToPx = mm => mm * DPI / 25.4;

  let wMM = 210, hMM = 297; // default A4

  if (type === "letter") { wMM = 216; hMM = 279; }
  if (type === "legal") { wMM = 216; hMM = 356; }

  let pageW = mmToPx(wMM);
  let pageH = mmToPx(hMM);

  if (orientation === "landscape") [pageW, pageH] = [pageH, pageW];

  return { pageW, pageH };
}

/* Year + mobile menu */
document.getElementById("year").textContent = new Date().getFullYear();
document.getElementById("hamburger").onclick = () =>
  document.getElementById("mobileMenu").classList.toggle("active");

</script>

</body>
</html>

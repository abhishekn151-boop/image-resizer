<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>Image Compressor — Reduce Image Size Online | Free Tools Hub</title>

  <!-- Robots -->
  <meta name="robots" content="index, follow" />

  <!-- Primary SEO -->
  <meta name="description" content="Compress images to an exact file size online. Fast, free, and 100% offline. Supports JPEG and WebP with high-quality optimization." />
  <meta name="keywords" content="image compressor, reduce image size, compress photo, online image compression, jpg compressor, webp compressor" />

  <meta name="google-adsense-account" content="ca-pub-2593603874978198">

  <!-- Canonical -->
  <link rel="canonical" href="https://freetoolshub.net/image-compressor/" />

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="/assets/favicon.png" />

  <!-- Open Graph -->
  <meta property="og:title" content="Image Compressor — Reduce Image Size Online" />
  <meta property="og:description" content="Compress images to an exact KB size without losing quality. 100% offline and private." />
  <meta property="og:image" content="https://freetoolshub.net/assets/logo.png" />
  <meta property="og:url" content="https://freetoolshub.net/image-compressor/" />
  <meta property="og:type" content="website" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Image Compressor — Fast Photo Compressor" />
  <meta name="twitter:description" content="Compress JPG or WebP images to a target file size instantly." />
  <meta name="twitter:image" content="https://freetoolshub.net/assets/logo.png" />

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-QZBLMM34MW"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-QZBLMM34MW');
  </script>

  <!-- CSS -->
  <link rel="stylesheet" href="/style.css" />

  <!-- Preload (moved to head) -->
  <link rel="preload" href="/utils.js" as="script">

  <!-- Preconnect (moved to head) -->
  <link rel="preconnect" href="https://www.googletagmanager.com">

  <!-- JSON-LD: Software Application -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "Image Compressor",
    "operatingSystem": "Web",
    "applicationCategory": "ImageEditing",
    "description": "Compress images offline inside your browser with exact target size output.",
    "url": "https://freetoolshub.net/image-compressor/",
    "image": "https://freetoolshub.net/assets/logo.png",
    "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" }
  }
  </script>

  <!-- JSON-LD: Breadcrumbs -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://freetoolshub.net/" },
      { "@type": "ListItem", "position": 2, "name": "Image Compressor", "item": "https://freetoolshub.net/image-compressor/" }
    ]
  }
  </script>

  <!-- JSON-LD: FAQ -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      { "@type":"Question", "name":"Is this image compressor free?", "acceptedAnswer":{"@type":"Answer","text":"Yes, it is completely free with no limits."} },
      { "@type":"Question", "name":"Does this tool upload my images?", "acceptedAnswer":{"@type":"Answer","text":"No. Everything runs inside your browser offline."} },
      { "@type":"Question", "name":"Can I compress an image to an exact KB size?", "acceptedAnswer":{"@type":"Answer","text":"Yes, the tool matches your target size automatically."} }
    ]
  }
  </script>

  <!-- Input Styling -->
  <style>
    .settings input, .settings select {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #2b3b5a;
      background: #0f1829;
      color: #e8ecf4;
      font-size: 14px;
    }
    .settings h3 { margin-top: 20px; }
  </style>
</head>
<body>

<!-- TOP NAVIGATION BAR -->
<div id="navbar"></div>
<script>
  fetch("/components/navbar.html")
    .then(r => r.text())
    .then(html => {
      document.getElementById("navbar").innerHTML = html;

      const ham = document.getElementById("hamburger");
      const menu = document.getElementById("mobileMenu");
      if (ham && menu) ham.onclick = () => menu.classList.toggle("active");
    });
</script>

<!-- HEADER -->
<header class="head">
  <h1>Image Compressor</h1>
  <p class="tagline">Compress images to an exact file size — 100% offline & private.</p>
</header>

<!-- TOOL -->
<div class="tool-container">

  <!-- UPLOAD -->
  <div id="drop-area" class="drop-area" role="button">
    <h2>Upload Image</h2>
    <p>Drop or Click</p>
    <input type="file" id="fileInput" accept="image/*" hidden />
  </div>

  <!-- SETTINGS -->
  <div class="settings">
    <h3>Target File Size (KB)</h3>
    <input id="targetSizeKB" type="number" min="1" placeholder="e.g. 200" />

    <h3>Format</h3>
    <select id="formatSelect">
      <option value="image/jpeg">JPEG</option>
      <option value="image/webp">WebP</option>
    </select>
  </div>

  <!-- PREVIEW -->
  <div class="preview-section">
    <h3>Preview</h3>
    <img id="previewImg" class="preview-img" alt="Preview appears here" />
    <p id="previewInfo"></p>
  </div>

</div>

<!-- ACTIONS -->
<div class="actions">
  <button id="processBtn" class="btn">Compress</button>
  <button id="downloadBtn" class="btn disabled" disabled>Download</button>
</div>

<!-- LOADER -->
<div id="loadingOverlay" class="loading-overlay hidden">
  <div class="spinner"></div>
  <p>Processing...</p>
</div>
<!-- SEO CONTENT -->
<section class="seo-section">
  <h2>Compress Images Online — Fast, Accurate & Secure</h2>
  <p>
    Free Tools Hub provides a powerful image compressor that allows you to reduce image size 
    to an exact target file size in KB. All processing happens <strong>offline in your browser</strong>, 
    guaranteeing complete privacy. No image is ever uploaded to a server.
  </p>

  <h3>Why Use Our Image Compressor?</h3>
  <ul>
    <li>Compress images to an exact KB value</li>
    <li>Offline processing ensures full privacy</li>
    <li>Supports JPG and WebP formats</li>
    <li>Optimizes quality while reducing size</li>
    <li>Works on all devices: mobile, tablet, and desktop</li>
  </ul>

  <h3>How to Compress an Image</h3>
  <ol>
    <li>Upload an image or drag it into the upload area.</li>
    <li>Enter your target file size in KB.</li>
    <li>Select output format (JPEG or WebP).</li>
    <li>Click <strong>Compress</strong> to generate the optimized image.</li>
    <li>Preview and download your compressed file.</li>
  </ol>

  <!-- Related Tools (SEO Internal Linking) -->
  <h3>Related Tools</h3>
  <div class="related-tools-btns">
    <a class="tool-btn" href="/image-resizer/">Image Resizer</a>
    <a class="tool-btn" href="/image-to-pdf/">Image to PDF</a>
    <a class="tool-btn" href="/jpg-to-png/">JPG to PNG</a>
    <a class="tool-btn" href="/png-to-jpg/">PNG to JPG</a>
  </div>
</section>

<!-- FOOTER -->
<footer class="vertical-footer">
  <div class="footer-container">

    <!-- Column 1: Site Pages -->
    <div class="footer-col">
      <h4>Site</h4>
      <a href="/about.html">About Us</a>
      <a href="/privacy.html">Privacy Policy</a>
      <a href="/terms.html">Terms of Service</a>
      <a href="/contact.html">Contact</a>
      <a href="/faq.html">FAQ</a>
    </div>

    <!-- Column 2: Tools -->
    <div class="footer-col">
      <h4>Tools</h4>
      <a href="/image-compressor/">Image Compressor</a>
      <a href="/image-resizer/">Image Resizer</a>
      <a href="/image-to-pdf/">Image to PDF</a>
      <a href="/jpg-to-png/">JPG to PNG</a>
      <a href="/png-to-jpg/">PNG to JPG</a>
    </div>

  </div>

  <p class="footer-copy">© <span id="year"></span> Free Tools Hub — All Rights Reserved.</p>
</footer>

<!-- STYLES for Footer and Buttons -->
<style>
.footer-container {
  display: flex;
  justify-content: center;
  gap: 80px;
  padding: 30px 0;
  flex-wrap: wrap;
}

.footer-col {
  display: flex;
  flex-direction: column;
  min-width: 150px;
}

.footer-col h4 {
  color: #7fc6ff;
  font-weight: bold;
  margin-bottom: 10px;
  font-size: 16px;
}

.footer-col a {
  color: #c9d6e2;
  text-decoration: none;
  margin-bottom: 6px;
  font-size: 14px;
}

.footer-col a:hover {
  color: #ffffff;
}

.footer-copy {
  text-align: center;
  margin-top: 10px;
  padding-bottom: 20px;
  font-size: 14px;
  color: #b0c4d4;
}

/* Related Tools Button Styles */
.related-tools-btns {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-top: 15px;
}

.tool-btn {
  background: #1f9bff;
  padding: 10px 14px;
  border-radius: 8px;
  color: white;
  font-weight: 600;
  text-decoration: none;
  display: inline-block;
}

.tool-btn:hover {
  background: #0d7ed6;
}
</style>

<!-- Set Dynamic Year in Footer -->
<script>
  document.getElementById("year").textContent = new Date().getFullYear();
</script>

<!-- MAIN SCRIPT (Processing Logic - UNCHANGED) -->
<script type="module">
  import {
    loadImage,
    getExifOrientation,
    applyOrientation,
    safeURL,
    formatDim,
    formatSize,
    canvasToBlob,
    compressCanvasToTarget
  } from "/utils.js";

  const fileInput = document.getElementById("fileInput");
  const dropArea = document.getElementById("drop-area");
  const previewImg = document.getElementById("previewImg");
  const previewInfo = document.getElementById("previewInfo");

  const targetSizeKB = document.getElementById("targetSizeKB");
  const formatSelect = document.getElementById("formatSelect");

  const processBtn = document.getElementById("processBtn");
  const downloadBtn = document.getElementById("downloadBtn");
  const loading = document.getElementById("loadingOverlay");

  let currentFile = null;
  let currentImage = null;
  let currentOrientation = 1;

  function setStatus(msg) { previewInfo.textContent = msg; }
  function showLoader() { loading.classList.remove("hidden"); }
  function hideLoader() { loading.classList.add("hidden"); }
  function enableDownload(v) {
    downloadBtn.disabled = !v;
    downloadBtn.classList.toggle("disabled", !v);
  }

  function prevent(e){ e.preventDefault(); e.stopPropagation(); }
  ["dragenter","dragover","dragleave","drop"].forEach(ev =>
    dropArea.addEventListener(ev, prevent)
  );

  dropArea.addEventListener("drop", e => handleFiles(e.dataTransfer.files));
  dropArea.addEventListener("click", () => fileInput.click());
  fileInput.addEventListener("change", () => handleFiles(fileInput.files));

  async function handleFiles(files) {
    const file = files[0];
    if (!file || !file.type.startsWith("image/")) return alert("Upload an image");

    currentFile = file;
    currentOrientation = await getExifOrientation(file).catch(() => 1);

    currentImage = await loadImage(file);
    previewImg.src = safeURL(file);
    previewImg.style.display = "block";

    setStatus(
      formatSize(file.size) +
      " • " +
      currentImage.naturalWidth + "×" + currentImage.naturalHeight
    );

    enableDownload(false);
  }

  async function compressImage() {
    if (!currentImage) return alert("Upload an image first!");

    const kb = Number(targetSizeKB.value);
    if (!kb || kb <= 0) return alert("Enter target size (KB)");

    showLoader();
    processBtn.disabled = true;
    setStatus("Compressing...");

    try {
      const W = currentImage.naturalWidth;
      const H = currentImage.naturalHeight;

      const temp = document.createElement("canvas");
      temp.width = W;
      temp.height = H;
      const tctx = temp.getContext("2d");

      const rawCanvas = document.createElement("canvas");
      rawCanvas.width = W;
      rawCanvas.height = H;
      rawCanvas.getContext("2d").drawImage(currentImage, 0, 0);

      const oriented =
        currentOrientation !== 1 ? applyOrientation(rawCanvas, currentOrientation) : rawCanvas;

      tctx.drawImage(oriented, 0, 0);

      const result = await compressCanvasToTarget(temp, {
        mime: formatSelect.value,
        targetBytes: kb * 1024
      });

      const url = safeURL(result.blob);
      previewImg.src = url;

      setStatus(
        formatSize(result.achievedBytes) +
        " • " + formatDim(result.width, result.height)
      );

      downloadBtn.onclick = () => {
        const a = document.createElement("a");
        const ext = formatSelect.value.split("/")[1];
        a.href = url;
        a.download = "compressed." + ext;
        a.click();
      };

      enableDownload(true);

    } catch (e) {
      alert("Compression failed");
      console.error(e);
    }

    hideLoader();
    processBtn.disabled = false;
  }

  processBtn.addEventListener("click", compressImage);
</script>

<!-- Lazy Loading Enhancement -->
<script>
  document.querySelectorAll("img").forEach(img => {
    img.loading = "lazy";
  });
</script>

</body>
</html>
